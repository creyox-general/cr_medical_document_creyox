<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="credit_receipt_form_view" model="ir.ui.view">
        <field name="name">credit.receipt.form.view</field>
        <field name="model">lyg.account.receipt</field>
        <field name="inherit_id" ref="lyg_receipt.view_account_receipt_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="before">
                <field name="is_credit_receipt" string="Is Credit Receipt"/>
            </xpath>
            <xpath expr="//field[@name='currency_code']" position="after">
                <field name="credit_receipt" invisible="0"/>
                <field name="normal_receipt" invisible="0"/>
                <field name="credit_receipt_count" invisible="0"/>
            </xpath>
            <xpath expr="//button[@name='action_send_receipt']" position="after">
                <button string="Create Credit Receipt" class="oe_highlight"
                        invisible="credit_receipt_count == 1 or is_credit_receipt == True or state == 'draft'"
                        name="action_post_credit_receipt" type="object"/>
            </xpath>
            <xpath expr="//sheet/div[@name='button_box']" position="inside">
                  <button name="button_credit_receipts" type="object"
                          class="oe_stat_button" icon="fa-files-o"
                          invisible="state == 'draft' or  credit_receipt_count == 0">
                          <span>Credit Receipt</span>
                </button>
            </xpath>
        </field>
    </record>

    <record id="action_account_credit_receipt_form" model="ir.actions.act_window">
        <field name="name">Receipt</field>
        <field name="res_model">lyg.account.receipt</field>
        <field name="view_mode">list,form</field>
        <field name="view_id" ref="lyg_receipt.view_account_receipt_list"/>
        <field name="domain">[('is_credit_receipt','=',True)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new Credit Receipt
            </p>
        </field>
    </record>

    <menuitem id="menu_account_credit_receipt" parent="account.menu_finance_receivables"
                  sequence="4" action="action_account_credit_receipt_form" name="Credit Receipt"/>
</odoo>
